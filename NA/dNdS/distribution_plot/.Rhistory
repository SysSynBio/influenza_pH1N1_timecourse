source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
sqrt(0.135)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, color=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Relative Solvent Accessibility") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=1.9, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, color=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Relative Solvent Accessibility") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.75, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer + Bush.99, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.2 <- ggplot() +
geom_point(data=d, aes(x=(1/distance.to.224), y=FEL.dN.dS, colour=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 0.25), breaks=seq(0, 0.25, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Inverse Distance to Site 224") +
geom_path(data=data.frame(x=c(0,0.25), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.75, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
p <- plot_grid(p1.1, p1.2, cols=2)
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, color=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Relative Solvent Accessibility") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.75, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
show(p1.1)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer + Bush.99, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.2 <- ggplot() +
geom_point(data=d, aes(x=(1/distance.to.224), y=FEL.dN.dS, colour=Bush.99), alpha=0.75) +
scale_x_continuous(limits=c(0, 0.25), breaks=seq(0, 0.25, length=4)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Inverse Distance to Site 224") +
geom_path(data=data.frame(x=c(0,0.25), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.75, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
show(p1.2)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
m
summary(m)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
d[d$FEL.dN.dS > 3.7]
d[d$FEL.dN.dS > 3.7, ]
d[d$FEL.dN.dS > 3.6, ]
d[d$FEL.dN.dS > 3.5, ]
d[d$FEL.dN.dS > 3.3, ]
d[d$FEL.dN.dS > 3.1, ]
d[d$FEL.dN.dS > 2.5, ]
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
summary(m)
d <- d[d$FEL.dN.dS < 3.0, ]
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
summary(m)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d <- d[d$FEL.dN.dS < 3.5, ]
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
summary(m)
sqrt(0.2616)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d <- d[d$FEL.dN.dS < 3.8, ]
m <- lm(FEL.dN.dS ~ I(1/distance.to.224) + RSA.Multimer, data=d)
summary(m)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, size=distance.to.224), alpha=0.75, size=2) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, by=0.2)) +
scale_size(name='1 / distance\nto site 224', range = c(2, 6)) +
ylim(0, 3.73) +
xlab("Relative Solvent Accessibility") +
ylab("dN/dS") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.15, y=3.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
show(p1.1)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
show(p1.1)
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d
d <- d[d$FEL.dN.dS < 3.0, ]
fit <- lm(FEL.dN.dS ~ REL.Multimer, data=d)
fit <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
summary(fit)
fit <- lm(FEL.dN.dS ~ I(1/distance.to.244), data=d)
fit <- lm(FEL.dN.dS ~ I(1/distance.to.224), data=d)
summary(fit)
d <- d[d$FEL.dN.dS < 2.5, ]
fit <- lm(FEL.dN.dS ~ I(1/distance.to.224), data=d)
summary(fit)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d <- d[d$RSA.Multimer < 0.75, ]
fit <- lm(FEL.dN.dS ~ I(1/distance.to.224), data=d)
summary(fit)
fit <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
summary(fit)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
d
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=predicted.w, y=FEL.dN.dS, size=1/distance.to.224, color=RSA.Multimer), alpha=0.75) +
scale_x_continuous(limits=c(0, 2.25), breaks=c(0, 1, 2)) +
scale_colour_gradientn(colours = cols, name='    RSA') +
scale_size(name='1 / distance\nto site 224', range = c(2, 6)) +
ylim(0, 3.73) +
xlab("Predicted dN/dS") +
ylab("Observed dN/dS") +
geom_path(data=data.frame(x=c(0,2.25), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=1.9, y=0.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
levels(d$Bush.99)
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer + Bush.99, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
summary(m)
levels(d$Bush.99)
levels(factors(d$Bush.99))
levels(factor(d$Bush.99))
source('~/Google Drive/Data/influenza_HA_evolution/analysis/defense_figures.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
predicted.w=predict(m, d)
predicted.w
predicted.w > 1
require(cowplot)
rm(list=ls())
gg_color_hue <- function(n) {
hues = seq(15, 375, length=n+1)
hcl(h=hues, l=65, c=100)[1:n]
}
cols = rev(gg_color_hue(3))
d <- read.table('~/Google Drive/Data/influenza_HA_evolution/manuscript/numbering_table.csv', sep=',', head=T, stringsAsFactors = F)
m <- lm(FEL.dN.dS ~ RSA.Multimer, data=d)
d <- cbind(d, predicted.w=predict(m, d))
r.value <- cor(d$FEL.dN.dS, d$predicted.w, use="complete.obs")
p1.1 <- ggplot() +
geom_point(data=d, aes(x=RSA.Multimer, y=FEL.dN.dS, size=1/distance.to.224), alpha=0.75) +
scale_x_continuous(limits=c(0, 1), breaks=seq(0, 1, by=0.2)) +
scale_size(name='1 / distance\nto site 224', range = c(2, 6)) +
ylim(0, 3.73) +
xlab("Relative Solvent Accessibility") +
ylab("dN/dS") +
geom_path(data=data.frame(x=c(0,1), y=c(0,2.25)), mapping=aes(x=x, y=y), color='black') +
annotate("text", x=0.15, y=3.5, label=paste("r = ", round(r.value, 3), "***", sep=""), color='black')
show(p1.1)
d$predicted.w
d$predicted.w >1
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
source('~/Google Drive/Data/influenza_HA_evolution/analysis/rsa_inversedistance_plot.R')
library(pwr)
pwr.t.test(d=0.4, sig.level = 0.05, power=0.8)
pwr.t.test(d=0.4, sig.level = 0.95, power=0.8)
pwr.t.test(d=0.4, sig.level = 0.90, power=0.8)
pwr.t.test(d=(0.4/2), sig.level = 0.90, power=0.8)
pwr.t.test(d=(0.4/2), sig.level = 0.05, power=0.8)
pwr.t.test(d=(0.4/2), sig.level = 0.1, power=0.8)
pwr.t.test(d=(0.4/2), sig.level = 0.05, power=0.8)
pwr.t.test(d=(0.4/2), sig.level = 0.05, power=0.9)
pwr.t.test(n=100, d=(0.4/2), sig.level = 0.05)
install.packages('bio3d')
install.packages(c("ape", "car", "caret", "digest", "Hmisc", "jsonlite", "magrittr", "manipulate", "mosaic", "quantreg", "RColorBrewer", "RCurl", "reshape2", "rmarkdown", "rstudioapi", "SparseM"))
install.packages(c("boot", "digest", "foreign", "manipulate", "MASS", "mgcv", "nlme", "RColorBrewer", "reshape2"), lib="/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
install.packages('bio3d')
install.packages("bio3d", dependencies=TRUE)
install.packages("installr"); library(installr)
install.packages("installr")
install.packages("~/Downloads/installr_0.15.3.tar.gz", repos = NULL, type = "source")
setwd('~/G\')
)
''
kdjfads
setwd('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/site_rates/')
ls()
list.files()*
8
list.files()
a <- read.table('rates_1.dat', head=T, sep=',')
a
hist(a$dN.dS)
a <- read.table('rates_25.dat', head=T, sep=',')
hist(a$dN.dS)
a$dN.dS
max(a$dN.dS)
hist(density(a$dN.dS)
)
library(ggplot2)
p <- ggplot(a, aes(x=dN.dS))
p <- p + geom_density()
show(p)
p <- p + scale_x_continuous(limit=c(0,10))
show(p)
setwd('../distances/')
a <- read.table('site_rates/rates_25.dat', head=T, sep=',')
a.map <- read.table('structure_maps/map_25.txt', head=T, sep=',')
a.map
a <- a[a.map != '-', ]
a
p <- ggplot(a, aes(x=dN.dS))
p <- p + geom_density()
show(p)
a <- read.table('site_rates/rates_1.dat', head=T, sep=',')
a.map <- read.table('structure_maps/map_1.txt', head=T, sep=',')
p <- ggplot(a, aes(x=dN.dS))
p <- p + geom_density()
show(p)
p <- p + scale_x_continuous(limit=c(0,154))
p <- p + scale_x_continuous(limit=c(0,15))
p <- ggplot(a, aes(x=dN.dS))
p <- p + geom_density()
p <- p + scale_x_continuous(limit=c(0,15))
show(p)
a <- read.table('site_rates/rates_25.dat', head=T, sep=',')
a.map <- read.table('structure_maps/map_25.txt', head=T, sep=',')
a <- a[a.map != '-', ]
p <- ggplot(a, aes(x=dN.dS))
p <- p + geom_density()
p <- p + scale_x_continuous(limit=c(0,15))
show(p)
a <- read.table('site_rates/rates_.dat', head=T, sep=',')
a <- read.table('site_rates/rates_1.dat', head=T, sep=',')
a.map <- read.table('structure_maps/map_25.txt', head=T, sep=',')
a.map <- read.table('structure_maps/map_1.txt', head=T, sep=',')
a <- a[a.map != '-', ]
p <- ggplot(a, aes(x=dN.dS))
p <- p + geom_density()
p <- p + scale_x_continuous(limit=c(0,15))
show(p)
library(cowplot)
show(p)
getwd()
setwd('../../../NA/dNdS/distribution_plot/')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
df
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
df[df$id == 1, ]
df$id
id
head(id)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
df
head(df)
df[df$id == 1, ]
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p1)
p1 <- plot.density(df[df$id == 1, ])
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
show(p)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
getwd()
setwd('../../../HA/dNdS/distribution_plot/')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
h3.dat <- read.table('~/Google Drive/Data/influenza_HA_evolution/data_table/numbering_table_unix.csv', head=T, sep=',')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
getwd()
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
paste('dNdS_distribution_', data$id[0], '.pdf', sep='')
paste('dNdS_distribution_', data$id[1], '.pdf', sep='')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/HA/dNdS/distribution_plot/plot_distributions.R')
setwd('../../../NA/dNdS/distribution_plot/')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/NA/dNdS/distribution_plot/plot_distributions.R')
