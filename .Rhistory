rm(list = ls())
library(ggplot2)
library(cowplot)
plot.density <- function(data, title) {
p <- ggplot(data, aes(x = x)) + geom_density()
p <- p + scale_x_continuous(limit = c(0, 4))
p <- p + ylab("Density")
p <- p + xlab('dN/dS')
p <- p + ggtitle(title)
ggsave(p, filename = paste('dNdS_distribution_', data$id[1], '.pdf', sep=''), height = 4.5, width=5)
return(p)
}
h3.dat <- read.table('~/Google Drive/Data/influenza_HA_evolution/data_table/numbering_table_unix.csv', head=T, sep=',')
get.df <- function(location) {
rates <- c()
id <- c()
for(i in 1:25){
rates.temp <- read.table(paste(location, '/dNdS/distribution_plot/site_rates/rates_', i, '.dat', sep=''), sep=',', head=T)
map <- read.table(paste(location, '/dNdS/distribution_plot/structure_maps/map_', i, '.txt', sep=''), head=F)
rates <- append(rates, rates.temp$dN.dS[map$V1 != '-'])
id <- append(id, rep(i, length(rates.temp$dN.dS[map$V1 != '-'])))
}
data.frame(x = rates, id = id)
}
ha.df <- get.df('HA')
na.df <- get.df('NA')
ha.df
rm(list = ls())
library(ggplot2)
library(cowplot)
plot.density <- function(data, title, column) {
data <- data[data$id == column, ]
p <- ggplot(data, aes(x = x)) + geom_density()
p <- p + scale_x_continuous(limit = c(0, 4))
p <- p + ylab("Density")
p <- p + xlab('dN/dS')
p <- p + ggtitle(title)
ggsave(p, filename = paste('dNdS_distribution_', data$id[1], '.pdf', sep=''), height = 4.5, width=5)
return(p)
}
h3.dat <- read.table('~/Google Drive/Data/influenza_HA_evolution/data_table/numbering_table_unix.csv', head=T, sep=',')
get.df <- function(location) {
rates <- c()
id <- c()
for(i in 1:25){
rates.temp <- read.table(paste(location, '/dNdS/distribution_plot/site_rates/rates_', i, '.dat', sep=''), sep=',', head=T)
map <- read.table(paste(location, '/dNdS/distribution_plot/structure_maps/map_', i, '.txt', sep=''), head=F)
rates <- append(rates, rates.temp$dN.dS[map$V1 != '-'])
id <- append(id, rep(i, length(rates.temp$dN.dS[map$V1 != '-'])))
}
data.frame(x = rates, id = id)
}
ha.df <- get.df('HA')
na.df <- get.df('NA')
p1 <- plot.density(ha.df, paste('Month 1'), 1)
p1 <- plot.density(ha.df, paste('Month 2'), 2)
p1 <- plot.density(ha.df, paste('Month 3'), 3)
p1 <- plot.density(ha.df, paste('Month 4'), 4)
p1 <- plot.density(ha.df, paste('Month 5'), 5)
p1 <- plot.density(ha.df, paste('Month 6'), 6)
p1 <- plot.density(ha.df, paste('Month 7'), 7)
p1 <- plot.density(ha.df, paste('Month 8'), 8)
p1 <- plot.density(ha.df, paste('Month 9'), 9)
p1 <- plot.density(ha.df, paste('Month 10'), 10)
p1 <- plot.density(ha.df, paste('Month 11'), 11)
p1 <- plot.density(ha.df, paste('Month 12'), 12)
p1 <- plot.density(ha.df, paste('Month 13'), 13)
p1 <- plot.density(ha.df, paste('Month 14'), 14)
p1 <- plot.density(ha.df, paste('Month 15'), 15)
p1 <- plot.density(ha.df, paste('Month 16'), 16)
p1 <- plot.density(ha.df, paste('Month 17'), 17)
p1 <- plot.density(ha.df, paste('Month 18'), 18)
p1 <- plot.density(ha.df, paste('Month 19'), 19)
p1 <- plot.density(ha.df, paste('Month 20'), 20)
p1 <- plot.density(ha.df, paste('Month 21'), 21)
p1 <- plot.density(ha.df, paste('Month 22'), 22)
p1 <- plot.density(ha.df, paste('Month 23'), 23)
p1 <- plot.density(ha.df, paste('Month 24'), 24)
p1 <- plot.density(ha.df, paste('Month 25'), 25)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
rm(list = ls())
library(ggplot2)
library(cowplot)
plot.density <- function(data, title, column, protein) {
data <- data[data$id == column, ]
p <- ggplot(data, aes(x = x)) + geom_density()
p <- p + scale_x_continuous(limit = c(0, 4))
p <- p + ylab("Density")
p <- p + xlab('dN/dS')
p <- p + ggtitle(title)
ggsave(p, filename = paste('distribution_plots/', protein,'_dNdS_distribution_', data$id[1], '.pdf', sep=''), height = 4.5, width=5)
return(p)
}
h3.dat <- read.table('~/Google Drive/Data/influenza_HA_evolution/data_table/numbering_table_unix.csv', head=T, sep=',')
get.df <- function(location) {
rates <- c()
id <- c()
for(i in 1:25){
rates.temp <- read.table(paste(location, '/dNdS/distribution_plot/site_rates/rates_', i, '.dat', sep=''), sep=',', head=T)
map <- read.table(paste(location, '/dNdS/distribution_plot/structure_maps/map_', i, '.txt', sep=''), head=F)
rates <- append(rates, rates.temp$dN.dS[map$V1 != '-'])
id <- append(id, rep(i, length(rates.temp$dN.dS[map$V1 != '-'])))
}
data.frame(x = rates, id = id)
}
ha.df <- get.df('HA')
na.df <- get.df('NA')
ha.p1 <- plot.density(ha.df, paste('Month 1'), 1, 'ha')
ha.p2 <- plot.density(ha.df, paste('Month 2'), 2, 'ha')
ha.p3 <- plot.density(ha.df, paste('Month 3'), 3, 'ha')
ha.p4 <- plot.density(ha.df, paste('Month 4'), 4, 'ha')
ha.p5 <- plot.density(ha.df, paste('Month 5'), 5, 'ha')
ha.p6 <- plot.density(ha.df, paste('Month 6'), 6, 'ha')
ha.p7 <- plot.density(ha.df, paste('Month 7'), 7, 'ha')
ha.p8 <- plot.density(ha.df, paste('Month 8'), 8, 'ha')
ha.p9 <- plot.density(ha.df, paste('Month 9'), 9, 'ha')
ha.p10 <- plot.density(ha.df, paste('Month 10'), 10, 'ha')
ha.p11 <- plot.density(ha.df, paste('Month 11'), 11, 'ha')
ha.p12 <- plot.density(ha.df, paste('Month 12'), 12, 'ha')
ha.p13 <- plot.density(ha.df, paste('Month 13'), 13, 'ha')
ha.p14 <- plot.density(ha.df, paste('Month 14'), 14, 'ha')
ha.p15 <- plot.density(ha.df, paste('Month 15'), 15, 'ha')
ha.p16 <- plot.density(ha.df, paste('Month 16'), 16, 'ha')
ha.p17 <- plot.density(ha.df, paste('Month 17'), 17, 'ha')
ha.p18 <- plot.density(ha.df, paste('Month 18'), 18, 'ha')
ha.p19 <- plot.density(ha.df, paste('Month 19'), 19, 'ha')
ha.p20 <- plot.density(ha.df, paste('Month 20'), 20, 'ha')
ha.p21 <- plot.density(ha.df, paste('Month 21'), 21, 'ha')
ha.p22 <- plot.density(ha.df, paste('Month 22'), 22, 'ha')
ha.p23 <- plot.density(ha.df, paste('Month 23'), 23, 'ha')
ha.p24 <- plot.density(ha.df, paste('Month 24'), 24, 'ha')
ha.p25 <- plot.density(ha.df, paste('Month 25'), 25, 'ha')
p <- ggdraw() +
draw_plot(ha.p1, 0.0, 0.8, 0.21, 0.2) +
draw_plot(ha.p2, 0.2, 0.8, 0.21, 0.2) +
draw_plot(ha.p3, 0.4, 0.8, 0.21, 0.2) +
draw_plot(ha.p4, 0.6, 0.8, 0.21, 0.2) +
draw_plot(ha.p5, 0.8, 0.8, 0.21, 0.2) +
draw_plot(ha.p6, 0.0, 0.6, 0.21, 0.2) +
draw_plot(ha.p7, 0.2, 0.6, 0.21, 0.2) +
draw_plot(ha.p8, 0.4, 0.6, 0.21, 0.2) +
draw_plot(ha.p9, 0.6, 0.6, 0.21, 0.2) +
draw_plot(ha.p10, 0.8, 0.6, 0.21, 0.2) +
draw_plot(ha.p11, 0.0, 0.4, 0.21, 0.2) +
draw_plot(ha.p12, 0.2, 0.4, 0.21, 0.2) +
draw_plot(ha.p13, 0.4, 0.4, 0.21, 0.2) +
draw_plot(ha.p14, 0.6, 0.4, 0.21, 0.2) +
draw_plot(ha.p15, 0.8, 0.4, 0.21, 0.2) +
draw_plot(ha.p16, 0.0, 0.2, 0.21, 0.2) +
draw_plot(ha.p17, 0.2, 0.2, 0.21, 0.2) +
draw_plot(ha.p18, 0.4, 0.2, 0.21, 0.2) +
draw_plot(ha.p19, 0.6, 0.2, 0.21, 0.2) +
draw_plot(ha.p20, 0.8, 0.2, 0.21, 0.2) +
draw_plot(ha.p21, 0.0, 0.0, 0.21, 0.2) +
draw_plot(ha.p22, 0.2, 0.0, 0.21, 0.2) +
draw_plot(ha.p23, 0.4, 0.0, 0.21, 0.2) +
draw_plot(ha.p24, 0.6, 0.0, 0.21, 0.2) +
draw_plot(ha.p25, 0.8, 0.0, 0.21, 0.2)
p.manuscript <- ggdraw() +
draw_plot(ha.p1, 0.0, 0, 1/3, 1) +
draw_plot(ha.p6, 1/3, 0, 1/3, 1) +
draw_plot(ha.p25, 2/3, 0, 1/3, 1)
ggsave(p, filename = 'distribution_plots/ha_dNdS_distribution.pdf', height = 15, width=15)
ggsave(p.manuscript, filename = 'distribution_plots/ha_dNdS_distribution_manuscript.pdf', height = 5, width=15)
h3.p <- plot.density(data.frame(x = h3.dat$FEL.dN.dS, id = rep('H3', length(h3.dat$FEL.dN.dS))), "Hemagglutinin 3")
ggsave(p, filename = 'distribution_plots/ha_dNdS_distribution.pdf', height = 15, width=15)
ggsave(p.manuscript, filename = 'distribution_plots/ha_dNdS_distribution_manuscript.pdf', height = 5, width=15)
h3.p <- plot.density(data.frame(x = h3.dat$FEL.dN.dS, id = rep('H3', length(h3.dat$FEL.dN.dS))), "Hemagglutinin 3")
h3.dat <- read.table('~/Google Drive/Data/influenza_HA_evolution/data_table/numbering_table_unix.csv', head=T, sep=',')
h3.dat
data.frame(x = h3.dat$FEL.dN.dS, id = rep('H3', length(h3.dat$FEL.dN.dS)))
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
rm(list = ls())
library(ggplot2)
library(cowplot)
plot.density <- function(data, title, column, protein) {
if(column != NA)
data <- data[data$id == column, ]
p <- ggplot(data, aes(x = x)) + geom_density()
p <- p + scale_x_continuous(limit = c(0, 4))
p <- p + ylab("Density")
p <- p + xlab('dN/dS')
p <- p + ggtitle(title)
ggsave(p, filename = paste('distribution_plots/', protein,'_dNdS_distribution_', data$id[1], '.pdf', sep=''), height = 4.5, width=5)
return(p)
}
h3.dat <- read.table('~/Google Drive/Data/influenza_HA_evolution/data_table/numbering_table_unix.csv', head=T, sep=',')
get.df <- function(location) {
rates <- c()
id <- c()
for(i in 1:25){
rates.temp <- read.table(paste(location, '/dNdS/distribution_plot/site_rates/rates_', i, '.dat', sep=''), sep=',', head=T)
map <- read.table(paste(location, '/dNdS/distribution_plot/structure_maps/map_', i, '.txt', sep=''), head=F)
rates <- append(rates, rates.temp$dN.dS[map$V1 != '-'])
id <- append(id, rep(i, length(rates.temp$dN.dS[map$V1 != '-'])))
}
data.frame(x = rates, id = id)
}
ha.df <- get.df('HA')
na.df <- get.df('NA')
h3.p <- plot.density(data.frame(x = h3.dat$FEL.dN.dS, id = rep('H3', length(h3.dat$FEL.dN.dS))), "Hemagglutinin 3", NA, 'h3')
data.frame(x = h3.dat$FEL.dN.dS, id = rep('H3', length(h3.dat$FEL.dN.dS)))
ha.df
head(ha.df)
rm(list = ls())
library(ggplot2)
library(cowplot)
plot.density <- function(data, title, column, protein) {
if(column != NA)
data <- data[data$id == column, ]
p <- ggplot(data, aes(x = x)) + geom_density()
p <- p + scale_x_continuous(limit = c(0, 4))
p <- p + ylab("Density")
p <- p + xlab('dN/dS')
p <- p + ggtitle(title)
ggsave(p, filename = paste('distribution_plots/', protein,'_dNdS_distribution_', data$id[1], '.pdf', sep=''), height = 4.5, width=5)
return(p)
}
h3.dat <- read.table('~/Google Drive/Data/influenza_HA_evolution/data_table/numbering_table_unix.csv', head=T, sep=',')
get.df <- function(location) {
rates <- c()
id <- c()
for(i in 1:25){
rates.temp <- read.table(paste(location, '/dNdS/distribution_plot/site_rates/rates_', i, '.dat', sep=''), sep=',', head=T)
map <- read.table(paste(location, '/dNdS/distribution_plot/structure_maps/map_', i, '.txt', sep=''), head=F)
rates <- append(rates, rates.temp$dN.dS[map$V1 != '-'])
id <- append(id, rep(i, length(rates.temp$dN.dS[map$V1 != '-'])))
}
data.frame(x = rates, id = id)
}
ha.df <- get.df('HA')
na.df <- get.df('NA')
ha.p1 <- plot.density(ha.df, paste('Month 1'), 1, 'ha')
ha.p2 <- plot.density(ha.df, paste('Month 2'), 2, 'ha')
ha.p3 <- plot.density(ha.df, paste('Month 3'), 3, 'ha')
ha.p4 <- plot.density(ha.df, paste('Month 4'), 4, 'ha')
ha.p5 <- plot.density(ha.df, paste('Month 5'), 5, 'ha')
ha.p6 <- plot.density(ha.df, paste('Month 6'), 6, 'ha')
ha.p7 <- plot.density(ha.df, paste('Month 7'), 7, 'ha')
ha.p8 <- plot.density(ha.df, paste('Month 8'), 8, 'ha')
ha.p9 <- plot.density(ha.df, paste('Month 9'), 9, 'ha')
ha.p10 <- plot.density(ha.df, paste('Month 10'), 10, 'ha')
ha.p11 <- plot.density(ha.df, paste('Month 11'), 11, 'ha')
ha.p12 <- plot.density(ha.df, paste('Month 12'), 12, 'ha')
ha.p13 <- plot.density(ha.df, paste('Month 13'), 13, 'ha')
ha.p14 <- plot.density(ha.df, paste('Month 14'), 14, 'ha')
ha.p15 <- plot.density(ha.df, paste('Month 15'), 15, 'ha')
ha.p16 <- plot.density(ha.df, paste('Month 16'), 16, 'ha')
ha.p17 <- plot.density(ha.df, paste('Month 17'), 17, 'ha')
ha.p18 <- plot.density(ha.df, paste('Month 18'), 18, 'ha')
ha.p19 <- plot.density(ha.df, paste('Month 19'), 19, 'ha')
ha.p20 <- plot.density(ha.df, paste('Month 20'), 20, 'ha')
ha.p21 <- plot.density(ha.df, paste('Month 21'), 21, 'ha')
ha.p22 <- plot.density(ha.df, paste('Month 22'), 22, 'ha')
ha.p23 <- plot.density(ha.df, paste('Month 23'), 23, 'ha')
ha.p24 <- plot.density(ha.df, paste('Month 24'), 24, 'ha')
ha.p25 <- plot.density(ha.df, paste('Month 25'), 25, 'ha')
p <- ggdraw() +
draw_plot(ha.p1, 0.0, 0.8, 0.21, 0.2) +
draw_plot(ha.p2, 0.2, 0.8, 0.21, 0.2) +
draw_plot(ha.p3, 0.4, 0.8, 0.21, 0.2) +
draw_plot(ha.p4, 0.6, 0.8, 0.21, 0.2) +
draw_plot(ha.p5, 0.8, 0.8, 0.21, 0.2) +
draw_plot(ha.p6, 0.0, 0.6, 0.21, 0.2) +
draw_plot(ha.p7, 0.2, 0.6, 0.21, 0.2) +
draw_plot(ha.p8, 0.4, 0.6, 0.21, 0.2) +
draw_plot(ha.p9, 0.6, 0.6, 0.21, 0.2) +
draw_plot(ha.p10, 0.8, 0.6, 0.21, 0.2) +
draw_plot(ha.p11, 0.0, 0.4, 0.21, 0.2) +
draw_plot(ha.p12, 0.2, 0.4, 0.21, 0.2) +
draw_plot(ha.p13, 0.4, 0.4, 0.21, 0.2) +
draw_plot(ha.p14, 0.6, 0.4, 0.21, 0.2) +
draw_plot(ha.p15, 0.8, 0.4, 0.21, 0.2) +
draw_plot(ha.p16, 0.0, 0.2, 0.21, 0.2) +
draw_plot(ha.p17, 0.2, 0.2, 0.21, 0.2) +
draw_plot(ha.p18, 0.4, 0.2, 0.21, 0.2) +
draw_plot(ha.p19, 0.6, 0.2, 0.21, 0.2) +
draw_plot(ha.p20, 0.8, 0.2, 0.21, 0.2) +
draw_plot(ha.p21, 0.0, 0.0, 0.21, 0.2) +
draw_plot(ha.p22, 0.2, 0.0, 0.21, 0.2) +
draw_plot(ha.p23, 0.4, 0.0, 0.21, 0.2) +
draw_plot(ha.p24, 0.6, 0.0, 0.21, 0.2) +
draw_plot(ha.p25, 0.8, 0.0, 0.21, 0.2)
p.manuscript <- ggdraw() +
draw_plot(ha.p1, 0.0, 0, 1/3, 1) +
draw_plot(ha.p6, 1/3, 0, 1/3, 1) +
draw_plot(ha.p25, 2/3, 0, 1/3, 1)
ggsave(p, filename = 'distribution_plots/ha_dNdS_distribution.pdf', height = 15, width=15)
ggsave(p.manuscript, filename = 'distribution_plots/ha_dNdS_distribution_manuscript.pdf', height = 5, width=15)
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
source('~/.active-rstudio-document')
source('~/Google Drive/Data/influenza_pH1N1_timecourse/plot_distributions.R')
p.manuscript <- ggdraw() +
draw_plot(ha.p1, 0.0, 0, 1/3, 0.5) +
draw_plot(ha.p6, 1/3, 0, 1/3, 0.5) +
draw_plot(ha.p25, 2/3, 0, 1/3, 0.5) +
draw_plot(na.p1, 0.0, 0.5, 1/3, 0.5) +
draw_plot(na.p6, 1/3, 0.5, 1/3, 0.5) +
draw_plot(na.p25, 2/3, 0.5, 1/3, 0.5) +
draw_plot_label(c("A", "B"), c(0, 0), c(1, 0.5), size = 18)
ggsave(p.ha, filename = 'distribution_plots/ha_dNdS_distribution.pdf', height = 15, width=15)
ggsave(p.na, filename = 'distribution_plots/na_dNdS_distribution.pdf', height = 15, width=15)
ggsave(p.manuscript, filename = 'distribution_plots/dNdS_distribution_manuscript.pdf', height = 10, width=15)
